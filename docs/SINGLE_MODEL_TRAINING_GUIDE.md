# λ‹¨μΌ λ¨λΈ ν•™μµ κ°€μ΄λ“

μ΄ λ¬Έμ„λ” `train_single_model.py` μ¤ν¬λ¦½νΈλ¥Ό μ‚¬μ©ν•μ—¬ ν•λ‚μ λ¨λΈλ§ ν•™μµμ‹ν‚¤λ” λ°©λ²•μ„ μ„¤λ…ν•©λ‹λ‹¤.

## κ°μ”

`train_single_model.py`λ” μ „μ²΄ νμ΄ν”„λΌμΈμ„ μ‹¤ν–‰ν•μ§€ μ•κ³  SVM λλ” Random Forest μ¤‘ ν•λ‚μ λ¨λΈλ§ λΉ λ¥΄κ² ν•™μµν•κ³  ν‰κ°€ν•  μ μλ” λ…λ¦½μ μΈ μ¤ν¬λ¦½νΈμ…λ‹λ‹¤.

## μ£Όμ” νΉμ§•

- **λΉ λ¥Έ μ‹¤ν–‰**: ν•λ‚μ λ¨λΈλ§ ν•™μµν•λ―€λ΅ μ‹¤ν–‰ μ‹κ°„μ΄ λ‹¨μ¶•λ©λ‹λ‹¤
- **μ μ—°ν• μµμ…**: λ°μ΄ν„° μ¦κ°• ν¬ν•¨/μ μ™Έ μ„ νƒ κ°€λ¥
- **μ¦‰κ°μ μΈ κ²°κ³Ό**: ν•™μµ ν›„ λ°”λ΅ μ„±λ¥ ν‰κ°€ κ²°κ³Ό ν™•μΈ
- **μ„ νƒμ  μ €μ¥**: λ¨λΈ μ €μ¥ μ—¬λ¶€λ¥Ό λ€ν™”ν•μΌλ΅ μ„ νƒ

## μ‚¬μ©λ²•

### κΈ°λ³Έ μ‚¬μ©λ²•

```bash
# SVM λ¨λΈλ§ ν•™μµ (κΈ°λ³Έκ°’, λ°μ΄ν„° μ¦κ°• μ—†μ΄)
python train_single_model.py

# Random Forest λ¨λΈλ§ ν•™μµ
python train_single_model.py --model random_forest
```

### μµμ… μ„¤λ…

#### `--model` (λ¨λΈ μ„ νƒ)
- **μ„¤λ…**: ν•™μµν•  λ¨λΈ νƒ€μ…μ„ μ„ νƒν•©λ‹λ‹¤
- **μ„ νƒμ§€**: `svm`, `random_forest`
- **κΈ°λ³Έκ°’**: `svm`

```bash
# SVM ν•™μµ
python train_single_model.py --model svm

# Random Forest ν•™μµ
python train_single_model.py --model random_forest
```

#### `--with-augmentation` (λ°μ΄ν„° μ¦κ°• ν¬ν•¨)
- **μ„¤λ…**: λ°μ΄ν„° μ¦κ°•μ„ ν¬ν•¨ν•μ—¬ ν•™μµν•©λ‹λ‹¤
- **κΈ°λ³Έκ°’**: μ¦κ°• μ—†μ (λΉ λ¥Έ μ‹¤ν–‰μ„ μ„ν•΄)

```bash
# λ°μ΄ν„° μ¦κ°• ν¬ν•¨ν•μ—¬ SVM ν•™μµ
python train_single_model.py --model svm --with-augmentation

# λ°μ΄ν„° μ¦κ°• ν¬ν•¨ν•μ—¬ Random Forest ν•™μµ
python train_single_model.py --model random_forest --with-augmentation
```

#### `--use-existing-augmented` (κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„° μ‚¬μ©)
- **μ„¤λ…**: κΈ°μ΅΄μ— μƒμ„±λ μ¦κ°• λ°μ΄ν„°λ¥Ό μ¬μ‚¬μ©ν•©λ‹λ‹¤
- **κΈ°λ³Έκ°’**: μ‚¬μ© μ•ν•¨
- **μ¥μ **: μ¦κ°• μƒμ„± μ‹κ°„ μ μ•½ + μ¦κ°• ν¨κ³Ό μ μ§€

```bash
# κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„°λ΅ SVM ν•™μµ (κ¶μ¥)
python train_single_model.py --model svm --use-existing-augmented

# κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„°λ΅ Random Forest ν•™μµ
python train_single_model.py --model random_forest --use-existing-augmented
```

## μ‹¤ν–‰ κ³Όμ •

### 1. λ°μ΄ν„° λ΅λ”©
- ν›λ ¨/κ²€μ¦/ν…μ¤νΈ λ°μ΄ν„° λ΅λ“
- νΉμ§• μ¶”μ¶ μν–‰
- λ°μ΄ν„° μ¦κ°• (μ„ νƒμ‚¬ν•­)

### 2. λ¨λΈ ν›λ ¨
- GridSearchCVλ¥Ό ν†µν• ν•μ΄νΌνλΌλ―Έν„° μµμ ν™”
- 5-fold κµμ°¨ κ²€μ¦
- μµμ  νλΌλ―Έν„° μ„ νƒ

### 3. λ¨λΈ ν‰κ°€
- ν…μ¤νΈ μ„ΈνΈμ—μ„ μ„±λ¥ ν‰κ°€
- μ •ν™•λ„, F1-score, Precision, Recall κ³„μ‚°
- ν΄λμ¤λ³„ μ„±λ¥ λ¶„μ„

### 4. κ²°κ³Ό μ¶λ ¥
- μµμ  ν•μ΄νΌνλΌλ―Έν„°
- μ „μ²΄ μ„±λ¥ μ§€ν‘
- ν΄λμ¤λ³„ μƒμ„Έ μ„±λ¥
- Random Forestμ κ²½μ° νΉμ§• μ¤‘μ”λ„

### 5. λ¨λΈ μ €μ¥ (μ„ νƒμ‚¬ν•­)
- λ€ν™”ν• ν”„λ΅¬ν”„νΈλ΅ μ €μ¥ μ—¬λ¶€ κ²°μ •
- Pickle ν•μ‹μΌλ΅ μ €μ¥

## μ¶λ ¥ μμ‹

```
π― SVM λ¨λΈλ§ ν•™μµμ„ μ‹μ‘ν•©λ‹λ‹¤.
============================================================

π“ 1λ‹¨κ³„: λ°μ΄ν„° λ΅λ”© μ¤‘...
β… λ°μ΄ν„° λ΅λ”© μ™„λ£:
  ν›λ ¨ λ°μ΄ν„°: 120κ°
  κ²€μ¦ λ°μ΄ν„°: 40κ°
  ν…μ¤νΈ λ°μ΄ν„°: 40κ°

π¤– 2λ‹¨κ³„: SVM λ¨λΈ ν›λ ¨ μ¤‘...
β… λ¨λΈ ν›λ ¨ μ™„λ£:
  μµμ  μ μ: 0.8542
  μµμ  νλΌλ―Έν„°: {'C': 10, 'gamma': 0.01}
  ν›λ ¨ μ‹κ°„: 15.32μ΄

π“ 3λ‹¨κ³„: λ¨λΈ ν‰κ°€ μ¤‘...
β… λ¨λΈ ν‰κ°€ μ™„λ£:
  μ •ν™•λ„: 0.8750
  F1-score (macro): 0.8695
  μ •λ°€λ„ (macro): 0.8811
  μ¬ν„μ¨ (macro): 0.8750

π“ ν΄λμ¤λ³„ μ„±λ¥:
  watermelon_A:
    μ •λ°€λ„: 0.9231
    μ¬ν„μ¨: 0.9000
    F1-score: 0.9114
  watermelon_B:
    μ •λ°€λ„: 0.8333
    μ¬ν„μ¨: 0.8571
    F1-score: 0.8451
  watermelon_C:
    μ •λ°€λ„: 0.8667
    μ¬ν„μ¨: 0.8667
    F1-score: 0.8667

π’Ύ λ¨λΈμ„ μ €μ¥ν•μ‹κ² μµλ‹κΉ? (y/N): 

β±οΈ  μ „μ²΄ μ‹¤ν–‰ μ‹κ°„: 42.15μ΄
```

## μ‚¬μ© μ‹λ‚λ¦¬μ¤

### 1. λΉ λ¥Έ ν”„λ΅ν† νƒ€μ΄ν•‘
```bash
# λ°μ΄ν„° μ¦κ°• μ—†μ΄ λΉ λ¥΄κ² SVM ν…μ¤νΈ
python train_single_model.py --model svm
```

### 2. λ¨λΈ λΉ„κµλ¥Ό μ„ν• κ°λ³„ μ‹¤ν–‰
```bash
# κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„°λ΅ SVM μ‹¤ν–‰ ν›„ κ²°κ³Ό κΈ°λ΅
python train_single_model.py --model svm --use-existing-augmented > svm_results.txt

# κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„°λ΅ Random Forest μ‹¤ν–‰ ν›„ κ²°κ³Ό κΈ°λ΅
python train_single_model.py --model random_forest --use-existing-augmented > rf_results.txt
```

### 3. μ „μ²΄ λ°μ΄ν„°λ΅ μµμΆ… λ¨λΈ ν•™μµ
```bash
# κΈ°μ΅΄ μ¦κ°• λ°μ΄ν„°λ΅ μµμΆ… λ¨λΈ ν•™μµ (κ¶μ¥)
python train_single_model.py --model svm --use-existing-augmented

# λλ” μƒλ΅μ΄ μ¦κ°• λ°μ΄ν„° μƒμ„±
python train_single_model.py --model svm --with-augmentation
```

### 4. μ¦κ°• λ°μ΄ν„° μ›ν¬ν”λ΅μ°
```bash
# 1λ‹¨κ³„: μµμ΄ μ¦κ°• λ°μ΄ν„° μƒμ„±
python train_single_model.py --model svm --with-augmentation

# 2λ‹¨κ³„: μƒμ„±λ μ¦κ°• λ°μ΄ν„° μ¬μ‚¬μ© (λΉ λ¥Έ μ‹¤ν–‰)
python train_single_model.py --model random_forest --use-existing-augmented

# 3λ‹¨κ³„: λ‹¤λ¥Έ μ„¤μ •μΌλ΅ λ™μΌ μ¦κ°• λ°μ΄ν„° μ¬μ‚¬μ©
python train_single_model.py --model svm --use-existing-augmented
```

## μ£Όμμ‚¬ν•­

1. **λ°μ΄ν„° μ”κµ¬μ‚¬ν•­**: `data/raw` λ””λ ‰ν† λ¦¬μ— ν›λ ¨/κ²€μ¦/ν…μ¤νΈ λ°μ΄ν„°κ°€ μμ–΄μ•Ό ν•©λ‹λ‹¤
2. **λ©”λ¨λ¦¬ μ‚¬μ©**: λ°μ΄ν„° μ¦κ°•μ„ ν¬ν•¨ν•λ©΄ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ΄ μ¦κ°€ν•©λ‹λ‹¤
3. **μ‹¤ν–‰ μ‹κ°„**: 
   - μ¦κ°• μ—†μ΄: μ•½ 30μ΄~1λ¶„
   - μ¦κ°• ν¬ν•¨: μ•½ 2~5λ¶„ (λ°μ΄ν„° μ–‘μ— λ”°λΌ λ‹¤λ¦„)

## λ¬Έμ  ν•΄κ²°

### "λ¨λ“μ„ μ°Ύμ„ μ μ—†μ" μ¤λ¥
```bash
# ν”„λ΅μ νΈ λ£¨νΈμ—μ„ μ‹¤ν–‰ν•λ”μ§€ ν™•μΈ
cd /path/to/wm_mlt_models
python train_single_model.py
```

### λ©”λ¨λ¦¬ λ¶€μ΅± μ¤λ¥
```bash
# λ°μ΄ν„° μ¦κ°• μ—†μ΄ μ‹¤ν–‰
python train_single_model.py --model svm
```

### κΈ΄ μ‹¤ν–‰ μ‹κ°„
- λ°μ΄ν„° μ¦κ°•μ„ μ μ™Έν•κ³  μ‹¤ν–‰
- λ” μ‘μ€ κµμ°¨ κ²€μ¦ ν΄λ“ μ μ‚¬μ© (μ½”λ“ μμ • ν•„μ”)

## λ‹¤μ λ‹¨κ³„

1. λ‹¨μΌ λ¨λΈ ν•™μµ ν›„ λ§μ΅±μ¤λ¬μ΄ κ²°κ³Όλ¥Ό μ–»μ—λ‹¤λ©΄:
   - `python main.py`λ΅ μ „μ²΄ νμ΄ν”„λΌμΈ μ‹¤ν–‰
   - Core ML λ³€ν™μ„ μ„ν•΄ λ¨λΈ μ €μ¥

2. μ„±λ¥μ„ κ°μ„ ν•κ³  μ‹¶λ‹¤λ©΄:
   - λ°μ΄ν„° μ¦κ°• ν¬ν•¨ν•μ—¬ μ¬ν•™μµ
   - λ‹¤λ¥Έ λ¨λΈ νƒ€μ… μ‹λ„
   - ν•μ΄νΌνλΌλ―Έν„° λ²”μ„ μ΅°μ • (μ½”λ“ μμ • ν•„μ”)

## κ΄€λ ¨ λ¬Έμ„

- [λ©”μΈ νμ΄ν”„λΌμΈ κ°€μ΄λ“](USAGE.md)
- [λ°μ΄ν„° μ¤€λΉ„ κ°€μ΄λ“](data_preparation_guide.md)
- [Core ML μ‚¬μ© κ°€μ΄λ“](COREML_USAGE.md)